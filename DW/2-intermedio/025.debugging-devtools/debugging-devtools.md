# Curso de Debugging con Chrome DevTools

> 31-05-2024

## 1. Introducci√≥n del curso e historia de Debugging Dev Tools

### ¬øPor qu√© Debugging?

El debugging nos ayuda a solucionar problemas que tengas con el software, ese problema debemos encontrarlo y solucionarlo, este proceso se le llama¬†**debugging.**

> Debugging es el proceso de encontrar y resolver defectos o problemas dentro de un programa (software) que impide el funcionamiento correcto del programa o sistema.

[Recurso oficial:](https://developers.google.com/web/tools/chrome-devtools)

## 2. Introducci√≥n a DevTools

Las dev tools son herramientas de desarrollo que vienen en todos los navegadores. No todas son iguales por lo que hay tools muy particulares dependiendo del navegador.

```bash
# Abrir DevTools
Ctrl + Shift + I
```

Elements: HTML
Styles: CSS
Sources: Archivos que se descargan al navegador una vez el proyecto empieza a cargar.

### Instalar Firefox Developer Edition en Linux Mint

[Descargar Firefox Developer Edition](https://www.mozilla.org/en-US/firefox/developer/).

Para instalar Firefox 127.0 Beta 9 en Linux Mint a partir del archivo `firefox-127.0b9.tar.bz2`, sigue estos pasos:

```bash
cd ~/Descargas

# Extraer el archivo
tar xjf firefox-127.0b9.tar.bz2

# Mover Firefox al directorio opt
sudo mv firefox /opt/firefox127
# Esto mantendr√° el sistema organizado.

# Crear un enlace simb√≥lico
sudo ln -s /opt/firefox127/firefox /usr/bin/firefox127

# Ejecutar Firefox
firefox127
```

**Crear un acceso directo (opcional)**:

Para crear un acceso directo en el men√∫ de aplicaciones:

- Crea un archivo de escritorio usando un editor de texto como `nano` o `gedit`:
	```bash
	sudo nano /usr/share/applications/firefox127.desktop
	```

- A√±ade el siguiente contenido al archivo:
     ```plaintext
     [Desktop Entry]
     Name=Firefox Beta 127
     Comment=Web Browser
     Exec=/opt/firefox127/firefox
     Icon=/opt/firefox127/browser/chrome/icons/default/default128.png
     Terminal=false
     Type=Application
     Categories=Network;WebBrowser;
     ```

   - Guarda el archivo y cierra el editor. Para guardar y salir de `nano`, sigue estos pasos:
	- **Guardar**: `Ctrl + O`, luego `Enter`
	- **Salir**: `Ctrl + X`

Ahora deber√≠as tener Firefox 127.0 Beta 9 instalado y listo para usar en tu sistema Linux Mint.

- [Atajos para DevTools Chrome](https://developers.google.com/web/tools/chrome-devtools/shortcuts)
- [Atajos para DevTools Firefox](All keyboard shortcuts[¬∂](https://firefox-source-docs.mozilla.org/devtools-user/keyboard_shortcuts/index.html#all-keyboard-shortcuts "Link to this heading"))

## 3. Editando HTML

Podemos ver el HTML de una p√°gina web en la secci√≥n de¬†**Elements**¬†del DevTools. Aqu√≠ podremos manipular el HTML o usar el selector y al tocar en algo en espec√≠fico dentro de la p√°gina en¬†**Elements**¬†se colocar√° en la l√≠nea de c√≥digo html que sea ese elemento seleccionado.

Para modificar textos dentro de etiquetas das doble clic, y tambi√©n en las etiquetas. 

> Los tres puntos a la derecha nos dejan arrastrar todo ese bloque de c√≥digo hacia otros lugares.

```html
Elements
... üëàüëÄ <div class="icon" role="presentation" alt=""></div>
```

### Shortcuts

- **Ctrl + Shift + C**, para activar el selector
- **Ctrl + F**, para hacer b√∫squedas dentro de¬†**Elements**, este comando tambi√©n sirve para buscar palabras dentro de una p√°gina web

## 4. Editando CSS

Para agregar una declaraci√≥n CSS a un elemento, use la pesta√±a Estilos cuando desee cambiar o agregar declaraciones CSS a un elemento.

- Haga clic derecho en el elemento a modificar a continuaci√≥n y seleccione Inspeccionar.
- Haga clic en la etiqueta, clase o Id cerca de la parte superior de la pesta√±a Estilos.
- Escribe `background-color` o el estilo deseado y presiona Enter.
- Escribe en este caso como ejemplo `honeydewy` presiona Enter, te debe quedar algo as√≠ `background-color: honeydewy`. En el √Årbol DOM, puede ver que se aplic√≥ una declaraci√≥n de estilo en l√≠nea al elemento.

Se puede dar doble clic sobre un elemento num√©rico y con las flechas subir y bajar el n√∫mero.

Tambi√©n podemos ver c√≥mo se comporta un elemento cuando se activa una¬†_pseudo-class_ desde el apartado `:hov`¬†y tambi√©n modificarla.

En la sub-secci√≥n¬†**Computed**¬†podemos ver todos los estilos que estrictamente solo se est√° aplicando a ese elemento seleccionado y podemos ver el modelo de caja tambi√©n.

### Dato

Una vez que realizamos los cambios en los estilos para depurar, es com√∫n olvidar cu√°les fueron todos los cambios que se realizaron en los estilos, para ello podemos acceder a la herramienta¬†**changes**¬†y observar estos cambios:

- Customize and control DevTools (3 puntos)
- More tools / Changes

### Shortcuts

Tambi√©n tenemos shortcuts para aumentar o disminuir el tama√±o de los elementos:

- **Shift + flecha arriba o flecha abajo** = modificas 10px el tama√±o. 
- **Ctrl + flecha arriba o flecha abajo** = modificas 100px el tama√±o. 
- **Alt + flecha arriba o flecha abajo** = modificas 0.1px el tama√±o.

## 5. Colores en DevTools

Para abrir el Selector de colores, encuentra una declaraci√≥n de CSS en el panel Styles que defina un color (como color: blue). A la derecha del valor de la declaraci√≥n se encuentra un cuadrado peque√±o de color. El color del cuadrado coincide con el valor de la declaraci√≥n. Haz clic en este peque√±o cuadrado para abrir el Selector de colores.

```css
element.style¬†{üëá
  background: üü™ darkslateblue;
}
```

Recordar:

Respecto a los colores de Material Design , para poder ver la combinaci√≥n de colores que se pueden aplicar a una p√°gina, en la secci√≥n mencionada de Material Design recordar dar un clic sostenido a cada uno para visualizar la l√≠nea de colores de esta forma:

Entrar a la paleta de colores y dirigirse a la secci√≥n de Material Design

![](https://i.postimg.cc/sxpFcqdq/5-material-design1.png)

Clic sostenido sobre la l√≠nea de colores que desee visualizar

![](https://i.postimg.cc/VvPpdgrR/5-material-design2.png)

## 6. Manejo de sombras en DevTools

A quienes no les aparezcan los tres puntitos para editar las sombras hagan esto:

1. Agreguen el estilo¬†**box-shadow**.
2. Seleccionen la opci√≥n:¬†**0 0 black**
3. Les aparecer√°n dos cuadritos superpuestos los cuales sacan un di√°logo que dice:¬†**"Open shadow editor"**
4. Hacen clic ah√≠ y listo.
5. Aplica lo mismo para: text-shadow

![open shadow editor](https://i.postimg.cc/xjz8b17p/6-open-shadow.png)

## 7. Animaciones en DevTools

- Customize and control DevTools (3 puntos)
- More tools / Animations

[P√°gina para probar animaciones](https://animate.style/)

Enlaces de bibliotecas de animaciones y efectos CSS:

- [Hover](https://ianlunn.github.io/Hover/)
- [CSShake](https://elrumordelaluz.github.io/csshake/)
- [Anijs](https://anijs.github.io/)
- [CSS Wand](https://www.csswand.dev/?ref=producthunt)
- [Animate Components](https://animate-components.surge.sh/)
- [Keyframes](https://keyframes.app/)
- [AniCollection](https://anicollection.github.io/#/)
- [SpinKit Loader](https://tobiasahlin.com/spinkit/)
- [Animejs](https://animejs.com/)

### Dato

Si cuando ingresan a **animate.css** y les aparece que no est√°n habilitadas las animaciones en su sistema operativo, solo tienen que ir a Configuraci√≥n de accesibilidad y Activar las animaciones.

## 8. ¬øC√≥mo medir el c√≥digo que no ocupamos?

- Customize and control DevTools (3 puntos)
- More tools / Coverage

![Coverage](https://i.postimg.cc/tCk9458V/8-coverage1.png)

Para empezar a usar esta herramienta solo das **Click the record button ‚ö´...**

En esta parte puedes limpiar todo o recargar la p√°gina para ver m√°s detalles de los archivos cargados.

En la parte de **Usage Visualization** tenemos barras de carga en rojo y blanco, lo cual indica el¬†**porcentaje de c√≥digo no utilizado**, tambi√©n expresado en bytes, de cada uno de los archivos, respecto del peso total de los mismos que est√° justamente en la columna que est√° a la izquierda, cuyo nombre es¬†**Total Bytes**.

![](https://i.postimg.cc/c4C8ZrbZ/8-coverage2.png)

Para ver el c√≥digo solo basta dar clic en alguno de los elementos en el apartado **URL**.

## 9. JavaScript y el DOM

Para obtener un elemento del DOM lo seleccionamos desde **Elements** en los DevTools de navegador y despu√©s vamos a la consola y escribimos `$0` esto nos traer√° ese elemento previamente seleccionado.

Para empezar a manipular elementos y para agregarles JavaScript podemos usar estas dos formas:

1. `getElementById()` = para llamar a un ID.
2. Vamos al elemento, damos clic derecho, nos saldr√° un men√∫ vamos a donde dice (copy) y despu√©s donde dice **Copy JS-PATH**
    Obtendremos algo parecido:
    `document.querySelector("Body > header")`    

![Copy JS path](https://i.postimg.cc/k5rgzyZ6/9-copy-js-path.png)

Posteriormente, con el elemento que obtengamos le podremos a√±adir funciones con JavaScript.

## 10. DevTools como editor (IDE)

- Sources
- Workspace: Add folder
- Seleccionar toda la carpeta
- Allow

Tambi√©n puedes agregar la carpeta desde tu explorador de archivos, arrastr√°ndola hasta¬†**Workspace**. Adem√°s puedes usar Ctrl + P para hacer busquedas rapidas de tus archivos.

![Workspace](https://i.postimg.cc/65jBk4YX/10-workspace.png)

**OJO:**¬†El css permite ser modificado desde el inspector de elementos tambi√©n, mientras que el HTML y el JavaScript, solo permite ser modificado desde la pesta√±a¬†**Sources**. Los cambios que hagas en el CSS del lado del inspector de elementos, se guardar√°n autom√°ticamente en el archivo CSS local. Los cambios que hagas y guardes desde la pesta√±a¬†**Sources**, se guardar√°n autom√°ticamente en los archivos locales.

‚ö†Ô∏è Es importante tener cuidado al modificar archivos locales importantes, ya que los cambios se guardar√°n autom√°ticamente y podr√≠an afectar el funcionamiento de tu aplicaci√≥n web. Siempre es recomendable hacer una copia de seguridad de tus archivos antes de realizar cambios importantes.

[Edit and save files in a workspace](https://developer.chrome.com/docs/devtools/workspaces)

## 11. Simular una ventana m√≥vil

El¬†**Device Mode**¬†es √∫til para saber de manera aproximada cu√°l ser√° el aspecto y el rendimiento de tu p√°gina en un dispositivo m√≥vil.

Device Mode es el nombre de un conjunto variado de funciones en Chrome DevTools que te ayudan a simular dispositivos m√≥viles. Estas funciones incluyen:

- Simulaci√≥n del viewport de un dispositivo m√≥vil
- Limitaci√≥n de la red
- Limitaci√≥n de la CPU
- Simulaci√≥n de la ubicaci√≥n geogr√°fica
- Configuraci√≥n de la orientaci√≥n

![device-toolbar.png](https://i.postimg.cc/gcHnSK5t/11-device-mode.png)

- [Responsive](https://responsively.app/)
- [Polypane](https://polypane.app/)

## 12. Manejo de sensores

 **Performance ‚öôÔ∏è** nos da algunas opciones como:
 - **Network** que permiten manipular la velocidad del internet.
 - **CPU** nos permite hacer pruebas simulando diferentes dispositivos con poder de c√≥mputo m√°s o menos potentes.

![](https://i.postimg.cc/sXyh6fYb/12-performance-network.png)

A pesar de que Dev Tools nos da estas herramientas, se recomienda comprar dispositivos no tan caros para poder probar nuestras p√°ginas.

Otra herramienta que nos ofrece Dev Tools es emular los sensores del dispositivo(geolocation, orietation, touch). Puedes acceder en la siguiente ruta:

- Customize and control DevTools (3 puntos)
- More tools / Sensors

![](https://i.postimg.cc/x1Y9hkJf/12-sensors.png)

Para saber las posiciones de orientaci√≥n de un celular necesitamos escuchar el evento¬†[DeviceOrientationEvent](https://developer.mozilla.org/en-US/docs/Web/API/DeviceOrientationEvent).

Usa la¬†[API](https://developer.mozilla.org/es/docs/WebAPI/Using_geolocation#:~:text=La%20API%20de%20geolocalizaci%C3%B3n%20permite,para%20proporcionar%20informaci%C3%B3n%20de%20ubicaci%C3%B3n)¬†de Geolocalizaci√≥n que tiene HTML5

## 13. Debugging JS con DevTools

Desde **Sources** activamos y escuchamos al evento **Click** desde **Event Listener Breakpoints > Mouse**. 

Esto lo que hace es generar un breakpoint que detiene la ejecuci√≥n del c√≥digo en la l√≠nea de la funci√≥n asociada al evento que estamos "escuchando".

![](https://i.postimg.cc/HW2SrRB2/13-event-listener.png)

Podemos hacer pruebas con esta [Demo :3](https://googlechrome.github.io/devtools-samples/debug-js/get-started)

## 14. Reproduciendo y reparando un bug

En JavaScript¬†**typeof**¬†retorna el tipo de dato que tiene una variable.

El panel¬†**Scope**¬†te muestra las variables locales y globales actualmente definidas, junto con el valor de cada variable.

![](https://i.postimg.cc/g04JX3Br/14-bug-fix.png)

Otro ejemplo de uso: [[closures_scope-en-js#**7.** ¬øQu√© es un Closure?#√Åmbito l√©xico]]

üìå Para los que usan Visual Studio Code, dejo un art√≠culo que nos muestra una extensi√≥n oficial (creada por Microsoft), para instalar¬†**Debugger for Chrome**, para implementar mucha de la funcionalidad del browser dentro de nuestro editor de texto.

[Debugger for Chrome](https://code.visualstudio.com/blogs/2016/02/23/introducing-chrome-debugger-for-vs-code)

## 15. Nota: proyecto de la clase siguiente

El proyecto que se utiliza en la siguiente clase,¬†**¬°ya est√° disponible!**  
Lo puedes encontrar üëâ¬†[aqu√≠](https://devtools.glitch.me/network/getstarted.html)

## 16. ¬øCu√°ndo utilizar Network en DevTools?

El panel Network es utilizado para asegurarse de que los recursos (HTML, im√°genes, CSS, JS, entre otros) se descarguen o carguen como se esperaba.

Los casos de uso m√°s comunes para el panel Network son:

- Asegurarse de que los recursos se est√©n cargando o descargando.
- Inspeccionar las propiedades de un recurso individual, como sus encabezados HTTP, contenido, tama√±o, etc.

**Secciones de Network**:

1. **Name**: Nombre del archivo
2. **Status**: Estatus del HTTP. En este caso 200 significa OK (Todo bien)
3. **Type**: Tipo de archivo. Por ejemplo: document (HTML), stylesheet(CSS), JS, PNG, etc.
4. **Inialitator**: Cu√°l archivo solicit√≥ a otro archivo. En este caso, el documento HTML solicit√≥ a todos los dem√°s archivos.
5. **Size**: Tama√±o del archivo. Se muestra el tama√±o no optimizado y optimizado por el navegador.
6. **Time**: Tiempo total que tarda en descargarse el archivo.
7. **Waterfall**: Tiempo (secci√≥n por secci√≥n) que le tom√≥ al archivo descargarse.

Se muestra de la siguiente manera:

![](https://i.postimg.cc/mgxbpmF0/15-network.png)

**NOTA**: Los c√≥digos de estado de respuesta HTTP indican si se ha completado satisfactoriamente una solicitud HTTP espec√≠fica. Las respuestas se agrupan en cinco clases:

- Respuestas informativas (100‚Äì199),
- Respuestas satisfactorias (200‚Äì299),
- Redirecciones (300‚Äì399),
- Errores de los clientes (400‚Äì499),
- y errores de los servidores (500‚Äì599).

**Referencias**:

- [C√≥digos de estado de respuesta HTTP | MDN](https://developer.mozilla.org/es/docs/Web/HTTP/Status).
- [Inspect Network Activity In Chrome DevTools](https://developers.google.com/web/tools/chrome-devtools/network/).

## 17. Revisando detalles con Network

üìå Para ver m√°s detalles como por ejemplo **Waterfall** solo dale clic derecho sobre **Name** y selecciona lo que necesites. Si eliges el icono ‚öôÔ∏è **Network settings** podr√°s tener mas opciones.

![](https://i.postimg.cc/6qPGmgkk/17-network-details.png)

En este apartado podemos simulando conexiones de red:

- **Online**¬†(Normal)¬†
- **Fast 3G**
- **Slow 3G**
- **Offline**
- **Custom**

Si mantenemos presionado el icono de **recargar p√°gina** en el navegador podremos elegir la opci√≥n **Vaciar cach√© y volver a cargar de manera forzada** para simular que se est√° abriendo la web por primera vez.

![](https://i.postimg.cc/xdq8WtRY/17-network-details2.png)

Tambi√©n podemos filtrar o bloquear archivos para que no se descarguen en el navegador.

**Ctrl + Shift + P** y escribimos **Show Request blocking** luego en el icono **+** y a√±adimos los archivos a bloquear `main.css`

![](https://i.postimg.cc/8kmzy7QT/17-lock-files.png)

Al recargar la p√°gina veremos que ese archivo no se carg√≥.

## 18. ¬øCuando utilizar la secci√≥n de Performance?

Para iniciar las pruebas podemos seguir los siguientes pasos:

- CPU: 4x slowdown

![](https://i.postimg.cc/8c7cZ8F5/18-performance-cpu-4x.png)

- Click the record button (Ctrl + E): 3 sec **Stop**

![](https://i.postimg.cc/XJ0t29py/18-performance-record.png)

En la parte inferior vemos un resumen del diagn√≥stico (summary): Si ves una l√≠nea roja, √≠ndica problemas.

![](https://i.postimg.cc/JzMqdKq8/18-performance-summary.png)

Adem√°s de Summary tambi√©n existen:

- Bottom-UP
- Call Tree
- Event Log

Para ver m√°s a detalle podemos ver en la siguiente secci√≥n: **Frames** y **Main** (con la rueda del mouse puedes ampliar)

![](https://i.postimg.cc/MpTrZqcH/18-performance-details.png)

Si le doy clic a algo que me interese de **Main**  puedo revisar en la parte inferior **Summary** para ver los detalles de la selecci√≥n hecha.

![](https://i.postimg.cc/ZnjtgHQM/18-performance-main-details.png)

üìå _Idle_¬†es el tiempo muerto, donde ya la p√°gina termin√≥ de realizar todos los pasos anteriores. Una p√°gina bien optimizada tendr√° un¬†_Idle_¬†mucho m√°s grande en relaci√≥n con los otros par√°metros en la pesta√±a de¬†_Summary_. Puede ser hasta m√°s de un 95% mayor que el resto de los par√°metros.

Adem√°s, si seleccionamos alg√∫n archivo con un pin en rojo üîªen **Summary** veremos el archivo que nos est√° dando problemas: Ejemplo `app.js 71`.

![](https://i.postimg.cc/9XwLnJ6R/18-performance-main-file.png)

Si le damos clic al archivo nos mostrar√° todo el c√≥digo, incluido el tiempo en que tarde en ejecutarse cada l√≠nea.

![](https://i.postimg.cc/kX3P1VpC/18-performance-debugging.png)

Las l√≠neas m√°s amarillas son las que se tardan m√°s en ejecutarse.

**Recuerden:**¬†Es una buena pr√°ctica generar 60 fps (frame por segundo)

[Janky Animation](https://googlechrome.github.io/devtools-samples/jank/)

### Reto: Comentario de un estudiante

**Conclusi√≥n sobre el reto**¬†Bueno, seg√∫n lo que he podido investigar (corregidme si estoy equivocado) es que el problema est√° en la forma en que obtiene una nueva posici√≥n para el elemento.

**_Algoritmo no optimizado_**

```js
var pos = m.classList.contains('down') ? m.offsetTop + distance : m.offsetTop - distance;
```

Aqu√≠ podemos observar que obtiene la posici√≥n del elemento con respecto al contenedor m√°s cercano en posici√≥n relativa (en este caso body) y esto lo hace para cada iteraci√≥n y cada elemento teniendo que cada vez volver a consultar esa posici√≥n para generar una nueva.

**_Algoritmo optimizado_**

```js
var pos = parseInt(m.style.top.slice(0, m.style.top.indexOf('px'))); m.classList.contains('down') ? pos += distance : pos -= distance;
```

Aqu√≠ para obtener la posici√≥n lee el estilo top anterior del elemento y a partir de ese genera una nueva posici√≥n.

La diferencia es que el primer algoritmo (offsetTop) consume mucho m√°s recursos ya que debe consultar del DOM en cada iteraci√≥n (es una nueva operaci√≥n para cada elemento y cada iteraci√≥n), mientras que con el segundo algoritmo (style.top) solamente consulta la posici√≥n anterior del estilo almacenado (no debe hacer una nueva operaci√≥n).

### Reto: Otro comentario

Creo que lo solucione, en la l√≠nea 65 (Dado que la l√≠nea que marca el Performance es la 95 que llama a la funci√≥n¬†**app.update**¬†en la l√≠nea 62)

Hay un condicional que dice: `if (!app.optimize)` y en la l√≠nea 32: `optimize = false;` al borrar el negar `(!)` se optimiza.

---

Hola @JuanGalvis, como t√∫ dices, si le quitas la negaci√≥n a la condici√≥n se optimiza porque por defecto esta expresi√≥n¬†`app.optimize`¬†tiene como valor¬†`false`. Este valor se cambia cada vez que haces clic en el bot√≥n ‚Äú_Optimize_‚Äù al igual que su texto, pasando de ‚Äú_Optimize_‚Äù a ‚Äú_Un-Optimize_‚Äù.

![](https://i.postimg.cc/MK6075mj/18-reto-img1.jpg)

Entonces al cambiar la condici√≥n, por defecto est√°s entrando en el c√≥digo de la condici√≥n que est√° optimizado.

![](https://i.postimg.cc/Hx0558J2/18-reto-img2.png)

Y esto te llevar√≠a a un error visual en cuanto al texto del bot√≥n porque si t√∫ cambias la condici√≥n y le das clic al bot√≥n aunque este diga ‚Äú_Optimize_‚Äù no optimizar√≠a el c√≥digo, sino todo lo contrario.

üëÄ Observando un poco m√°s el c√≥digo con las herramientas del navegador, creo que el error se encuentra en la l√≠nea 71.

![](https://i.postimg.cc/qvt3w5hg/18-reto-img3.jpg)

Se puede observar que debajo de la funci√≥n¬†`app.update`¬†se est√°n est√°n ejecutando otras cosas.¬†**Recalculate Style**¬†y¬†**Layout**¬†ambas con un tri√°ngulo rojo indicando que podemos estar haciendo algo mal en el c√≥digo. Le hago clic a ‚Äú_Recalculate Style_‚Äù y aparece:

- Un warning ‚ö†Ô∏è que dice:¬†_Forced reflow is a likely performance bottleneck_
- _Recalculation forced_¬†‚Äì `app.js:71`
- _First invalidated_¬†‚Äì `app.js:70`

Pero, ¬øqu√© es¬†**Recalculate Style**¬†y¬†**Layout**? ü§î

Para mostrar un¬†_frame_¬†en la pantalla el navegador sigue una serie de pasos:

![](https://i.postimg.cc/L4Ngppjn/18-reto-img4.jpg)

- **Recalculate Style**: El paso de combinar el DOM y el CSSOM obteniendo as√≠ el¬†_Render Tree_.
- **Layout**¬†(o tambi√©n llamado¬†_++Reflow++_): El paso que hace el navegador para averiguar el tama√±o y las posiciones de los elementos en la p√°gina.

A veces se puede forzar al navegador a realizar el¬†_layout_¬†de manera anticipada con JavaScript. A esto se le denomina¬†_**Forced synchronous layout**_. Y eso es lo que le est√° pasando a este c√≥digo.

En la l√≠nea 70:

```js
m.style.top = pos + 'px';
```

En JavaScript se est√° cambiando el estilo de la imagen, en este caso la posici√≥n top.

En la l√≠nea 71:

```js
if (m.offsetTop === 0) {
```

Con¬†`m.offsetTop`¬†se est√° pidiendo conocer el valor de esa propiedad del elemento para poder hacer la comparaci√≥n.

Si en la l√≠nea anterior (70) no se hace el cambio de estilo no habr√≠a problema porque se leer√≠a el valor del frame anterior pero al cambiar el estilo, el cambio hace que el navegador invalide ‚ùå todo lo que ten√≠a registrado y deba actualizar ‚úÖ los estilos (_Recalculate style_) y por lo tanto, ejecutar el¬†_layout_¬†para poder devolver el¬†_offsetTop_¬†correcto.

En otras palabras, esto lo hace porque al cambiar el estilo de la imagen y luego preguntar cual es la posici√≥n de la imagen el navegador no sabe si la posici√≥n ha cambiado y decide volver a ejecutar el paso de¬†_layout_¬†para poder obtener su posici√≥n.

Y como est√° en un ciclo üîÑ, est√°s operaciones se est√°n continuamente repitiendo. De ah√≠ el warning: ‚Äú_Forced reflow is a likely performance bottleneck_‚Äù.

Para evitar esto se recomienda:

- 1Ô∏è‚É£ Primero ++leer++ los estilos (ejemplo de leer: element.width)
- 2Ô∏è‚É£ Y luego ++escribirlos++ (ejemplo de escribir: element.width = '100px')

En la soluci√≥n del c√≥digo optimizado lo que hacen es a√±adir a la variable¬†`pos`¬†la posici√≥n de la imagen y es esta variable la que utilizan en la condici√≥n. Lo que consiguen con esto es:

- Que el navegador no tenga que estar averiguando en varias l√≠neas del c√≥digo que posici√≥n tiene la imagen.
- Que no se fuerce el¬†_Layout_¬†ya que en la l√≠nea anterior a la condici√≥n se sigue cambiando el estilo de la imagen.

Y si haces trabajar menos al navegador, el rendimiento de la p√°gina mejorar√° üí™.

En el enlace que puso el profesor tambi√©n se menciona que el c√≥digo se podr√≠a optimizar a√∫n m√°s si se utilizaran propiedades (_transform_¬†y¬†_opacity_) que s√≥lo afecten al √∫ltimo paso (_Composite_).

En general, con lo que me quedo es que las propiedades que cambiamos o leemos en JavaScript y d√≥nde lo hacemos afectan al rendimiento üòÖ.

Enlaces recomendados:

- [El que puso el profesor](https://developers.google.com/web/tools/chrome-devtools/evaluate-performance)
- [Y este que habla en profundidad sobre el layout](https://developers.google.com/web/fundamentals/performance/rendering/avoid-large-complex-layouts-and-layout-thrashing)

## 19. Auditor√≠a en mobile: Lighthouse

En esta secci√≥n elegimos **Mobile**

![](https://i.postimg.cc/9f5v1zXS/19-lighthouse.png)

![](https://i.postimg.cc/N0sZZST7/19-analyze.png)

![](https://i.postimg.cc/1XwW8rw3/19-result.png)

Puedes darle clic a los resultados para ver que podemos mejorar.

- [Preogressive Web App](https://developers.google.com/codelabs/pwa-training/pwa03--going-offline?hl=es#0)
- [Accessibility](https://web.dev/articles/accessibility)

## 20. Auditor√≠a en desktop: Lighthouse

En el icono de refrescar p√°gina, lo mantenemos seleccionado y elegimos **Vaciar cach√© y volver a cargar de manera forzada**.

Ahora en los **Lighthouse** elegimos **Desktop**

## 21. Cierre de curso

Tomar examen‚Ä¶

## 22. Contenido Bonus: PWA

Las Progressive Web Apps (PWAs) son aplicaciones web que combinan lo mejor de las p√°ginas web y las aplicaciones m√≥viles. La idea principal detr√°s de las PWAs es ofrecer una experiencia similar a la de una aplicaci√≥n nativa, pero utilizando tecnolog√≠as web. 

A continuaci√≥n, te explico de manera sencilla qu√© son y c√≥mo funcionan:

### Qu√© son las Progressive Web Apps

1. **Aplicaciones Web Mejoradas**: Son sitios web o p√°ginas web que se comportan como aplicaciones m√≥viles.
2. **Experiencia de Usuario**: Ofrecen una experiencia r√°pida, fiable y atractiva, similar a las aplicaciones nativas.
3. **Instalaci√≥n Opcional**: Pueden instalarse en el dispositivo del usuario sin necesidad de pasar por una tienda de aplicaciones como Google Play o App Store.
4. **Multiplataforma**: Funcionan en cualquier dispositivo con un navegador moderno, sin importar el sistema operativo.

### C√≥mo Funcionan las Progressive Web Apps

1. **Service Workers**: Este es un componente clave que permite que las PWAs funcionen offline o con conexiones inestables. Los Service Workers son scripts que el navegador ejecuta en segundo plano para manejar cach√© y solicitudes de red, mejorando la velocidad y la capacidad de trabajo sin conexi√≥n.
2. **Manifiesto Web (Web App Manifest)**: Es un archivo JSON que proporciona informaci√≥n sobre la aplicaci√≥n (nombre, iconos, tema de color, etc.) y c√≥mo deber√≠a comportarse cuando se "instala" en el dispositivo del usuario.
3. **HTTPS**: Las PWAs deben ser servidas a trav√©s de HTTPS para garantizar que la comunicaci√≥n entre el servidor y el cliente sea segura.
4. **Aplicaci√≥n Progresiva**: La "progresividad" significa que las PWAs funcionan para todos los usuarios, sin importar el navegador, ya que est√°n construidas con principios de mejora progresiva. Esto significa que utilizan funciones del navegador que son soportadas por todos y luego a√±aden funcionalidades adicionales para los navegadores m√°s avanzados.

### Para Qu√© Sirven las Progressive Web Apps

1. **Accesibilidad Sin Conexi√≥n**: Permiten a los usuarios acceder a contenido incluso cuando no tienen conexi√≥n a Internet, gracias a los Service Workers.
2. **Rendimiento Mejorado**: Las PWAs suelen ser m√°s r√°pidas porque cargan desde la cach√© en lugar de depender completamente de la red.
3. **Experiencia de Usuario Enriquecida**: Ofrecen notificaciones push, pantalla completa, y pueden ser agregadas al inicio del dispositivo, mejorando la interacci√≥n del usuario.
4. **Menor Consumo de Recursos**: Ocupan menos espacio y consumen menos recursos del dispositivo comparado con las aplicaciones nativas.
5. **Desarrollo Simplificado**: Los desarrolladores pueden crear una √∫nica aplicaci√≥n que funciona en m√∫ltiples plataformas sin necesidad de desarrollar versiones separadas para iOS, Android, etc.

### Ejemplos de Uso

- **E-commerce**: Tiendas online como AliExpress y Flipkart han implementado PWAs para mejorar la experiencia de compra.
- **Medios y Noticias**: Peri√≥dicos y sitios de noticias como The Washington Post y Financial Times usan PWAs para ofrecer acceso r√°pido y offline a sus art√≠culos.
- **Redes Sociales**: Twitter Lite es una versi√≥n PWA que ofrece una experiencia de usuario r√°pida y que consume menos datos.

En resumen, las Progressive Web Apps son una forma moderna y eficiente de ofrecer aplicaciones web con todas las ventajas de las aplicaciones nativas, sin los inconvenientes de instalaci√≥n y actualizaci√≥n a trav√©s de las tiendas de aplicaciones tradicionales.

## Funcionalidades √∫tiles de Chrome devtools no cubiertas en el curso

En este post te voy a mostrar algunas funcionalidades que posee Chrome DevTools y que no fueron cubiertas en el curso.

### üíª¬†**Variables $1 al $4**

En el curso vimos como podemos usar¬†**$0**¬†para acceder al actual elemento seleccionado en¬†**Elements**, pero adicionalmente existen otros¬†_shortcuts_¬†como¬†**$1**,¬†**$2**,¬†**$3**,¬†**$4**. En estas variables el devtools guardar√° los √∫ltimos 4 elementos que selecciones en el tab¬†**Elements**.

### üîç¬†**Shortcuts para querySelector y querySelectorAll**

Imagina que quieres saber cuantos botones hay en tu HTML, puedes usar `querySelectorAll` para averiguarlo:

```js
var buttons = document.querySelectorAll('button');
console.log(buttons.length)
// muestra el total de elementos
```

Gracias a los DevTools puedes r√°pidamente reemplazar esta funci√≥n por el doble d√≥lar¬†**`$$`**

```js
var buttons = $$('button');
console.log(buttons.length)
// muestra el total de elementos
```

Otro ejemplo:

![](https://i.postimg.cc/wBDHRyVS/vs-query-Selector-All.png)

Tener en cuenta que **`$$`** al ser una utilidad del DevTools retornar√° un arreglo, mientras que¬†`querySelectorAll` retorna un¬†**NodeList**. Pueden comprobarlo con el siguiente c√≥digo:

```js
var buttons = $$('button');
Array.isArray(buttons) // retorna true

// 
var buttons = document.querySelectorAll('button');
console.log(buttons) // retorna false
```

Para el caso de¬†`querySelector`, su alias es¬†**`$`**¬†y tambi√©n es una funci√≥n a la que debemos pasarle un selector, ambas funciones retornan un elemento del DOM y no hay un cambio en el tipo de dato como en¬†`querySelectorAll`

**Tener en cuenta que al ser variables globales pueden ser reemplazadas f√°cilmente, por ejemplo si tienes jQuery en tu HTML el¬†**`$`**¬†ser√° jQuery y no querySelector**

### ‚úèÔ∏è¬†**Copiar una variable**

Vamos a suponer que tenemos una funci√≥n que tras realizar una llamada **http** retorna un objeto que representa la informaci√≥n de un usuario.

```js
function fetchUser() {
   var user = {
  	id: 1,
	name: 'Eduardo',
	age: 33,
	country: 'Peru',
	salary: 100
   };
  return user;
}
```

Ahora imagina que necesitas todo ese objeto para pegarlo en otra herramienta y hacer alg√∫n proceso con esa informaci√≥n, lo normal ser√≠a hacer un `console.log` al objeto, seleccionarlo y copiarlo. !Aburrido! 

DevTools te ahorra ese proceso con su funci√≥n¬†**copy**

```js
function fetchUser() {
   var user = {
  	id: 1,
	name: 'Eduardo',
	age: 33,
	country: 'Peru',
	salary: 100
   };
  
  copy(user) // ahora tienes este objeto en tu porta papeles
  return user;
}
```

Listo, cuando ejecutes la funci√≥n podr√°s hacer `Ctrl/cmd + V` y pegar el objeto en cualquier lado.

### üïµÔ∏è¬†**Seleccionar elementos v√≠a c√≥digo con inspect**

Buscar y seleccionar un elemento es muy simple con DevTools, simplemente haces clic en el icono de la flecha con el cuadradito (`Ctrl + Shift + C`) y luego vas al HTML y haces clic sobre el elemento que deseas, f√°cil. Pero hay una manera¬†_fancy_¬†de hacerlo desde c√≥digo gracias al m√©todo¬†**inspect**.  
Este m√©todo acepta como par√°metro un elemento del DOM.

```js
var button = document.querySelector('#my-button');
inspect(button);
```

Al ejecutarse la funci√≥n inspect autom√°ticamente, el DevTools cambiar√° al tab¬†**Elements**¬†y te mostrar√° el elemento que corresponda al selector¬†**my-button**.

### üëÄ¬†**Monitorear una funci√≥n**

¬øHeredaste un c√≥digo largu√≠simo y dif√≠cil de entender? ¬øLas funciones y variables tienen nombres de letras como¬†**x**,¬†**z**? ¬øEst√°s leyendo esto con voz de vendedor de teleferia? No te preocupes, con la funci√≥n¬†**monitor**¬†DevTools te avisar√° cuando alguna funci√≥n de tu c√≥digo ha sido llamada.

En el siguiente c√≥digo veremos a una funci√≥n que retorna un simple objeto

```js
function fetchUser() {
   var user = {
    id: 1,
    name: 'Eduardo',
    age: 33,
    country: 'Peru',
    salary: 100
   };
  return user;
}
```

Si deseo que los DevTools me avise cada vez que se ha ejecutado la funci√≥n solo debo hacer lo siguiente:

```js
monitor(fetchUser);
// Ejecutamos la funci√≥n
fetchUser();
// Nos aparecer√° el siguiente mensaje:
// function fetchUser called
```

### üì∑¬†**Tomar screenshots**

Quieres pasarle un screenshot a alguien de un elemento del DOM espec√≠fico. Pues simple, selecciono el elemento del DOM usando el DevTools, y luego presiono¬†`Ctrl + Shift + P`¬†se abrir√° un modal con un listado de comandos de acciones del DevTools, escribimos ‚Äúcapture node screenshot‚Äù y autom√°ticamente se guardar√° la imagen del nodo seleccionado. Adicionalmente, se puede generar screenshot de toda la pantalla o incluso dar la opci√≥n de seleccionar una parte en espec√≠fico.

![](https://i.postimg.cc/KvZsbKw0/capture-node-screenshot.png)

Algo as√≠:

![](https://i.postimg.cc/J7BBhPVn/devtools-capture-screenshot.gif)

## üî• Examen

<details>
  <summary>Haz clic para ver los resultados üëÄüëá</summary>
  <br/>

1. ¬øQu√© tipo de interacci√≥n podemos tener en la secci√≥n de Elements?

	- ‚úÖ Manipulaci√≥n de nuestro HTML.

2. ¬øCu√°les son los navegadores que tienen herramientas para desarrolladores?

	- ‚úÖ Todos los navegadores tienen herramientas para desarrolladores.

3. ¬øC√≥mo podr√≠a visualizar la paleta de colores que mi proyecto est√° utilizando?

	- ‚úÖ Desde la secci√≥n de estilos, al tener un elemento que tenga aplicado alg√∫n color, d√°ndole clic al cuadro de color que aparece ah√≠, tendremos la opci√≥n de Page colors que hace referencia a la paleta de colores del proyecto.

4. Si tengo un error en mi c√≥digo que se dispara al momento de mandar llamar una funci√≥n que est√° ligada a un bot√≥n, ¬øc√≥mo podr√≠a llegar a esa funci√≥n para comenzar a debuggear el c√≥digo?

	- ‚úÖ Tendr√≠amos que comenzar con el evento de click en ese bot√≥n.

5. Si yo NO tengo la secci√≥n de Animaci√≥n en mi DevTools, ¬øC√≥mo puedo visualizarla?

	- ‚úÖ En la parte de men√∫ de tu devtools, tengo que ir a m√°s herramientas ‚ÄúMore Tools‚Äù, y ah√≠ buscar por Animaciones.

6. ¬øSi en mi proyecto estoy utilizando un preprocesador de css como ‚ÄúStylus‚Äù, y utilizo DevTools como IDE, puedo seguir trabajando desde ah√≠ con Stylus?

	- ‚úÖ Claro, DevTools, te dejar√° trabajar con todos los preprocesadores de CSS.

7. ¬øQu√© es el JS Path que obtenemos de cada elemento de HTML?

	- ‚úÖ Es la selecci√≥n que hacemos a un nodo o elemento del DOM espec√≠fico con JS

8. ¬øD√≥nde puedo ver si mis elementos de HTML tienen alg√∫n estado de CSS?

	- ‚úÖ mal No se puede, porque tienen primero que activar el estado.
	-  Eso es algo que solo se puede ver en Firefox.
	- ‚úÖ mal Desde la secci√≥n de estilos, en el icono de :hov
	- Seleccionando ese elemento y viendo sus estilos.

9. ¬øPara qu√© utilizamos ‚ÄúNetwork‚Äù en DevTools?

	- ‚úÖ Esto nos sirve para poder ver ¬øqu√© archivos y assets se est√°n descargando, el estatus, el peso y tiempo de descarga de los mismos?

10. ¬øC√≥mo podr√≠a cargar mi proyecto desde local, para comenzar a guardar los cambios desde DevTools?

	- ‚úÖ Directamente desde la secci√≥n de sources seleccionamos ‚ÄúFilesystem‚Äù y ‚Äúagregar un folder a mi espacio de trabajo‚Äù

11. ¬øCu√°l es la secci√≥n en la que puedo tener visibilidad del todo el c√≥digo que no estoy utilizando en un proyecto?

	- ‚úÖ Desde la secci√≥n de ‚ÄúCoverage‚Äù yo puedo tener visibilidad del c√≥digo que est√° en mi proyecto, pero no es necesario porque no lo utilizo.

12. ¬øDe qu√© forma puedo buscar palabras espec√≠ficas en mi documento html, desde el inspector de elementos?

	- ‚úÖ Presionando ‚Äúcomand/ctrl + F‚Äù desde la casilla de Elements

13. ¬øPara qu√© puedo utilizar el `$0` en la consola de DevTools?

	- ‚úÖ Me sirve para ver cual es el elemento de HTML que estoy seleccionando.

14. ¬øCu√°l es la forma m√°s r√°pida de generar sombras a mis elementos de html?

	- ‚úÖ Desde la secci√≥n de estilos, al momento de estar modificando los estilos de alg√∫n elemento, tendremos un icono de 3 puntos que hace referencia a un men√∫, ah√≠ encontraremos la opci√≥n para poder agregar sombras a elementos y texto.

15. ¬øCu√°les son las estrategias que existen para poder trabajar proyectos responsive?

	- ‚úÖ Por viewport de dispositivo, o por dise√±o.

</details>

üëàüëÄ
üëá
üìå
‚úÖ