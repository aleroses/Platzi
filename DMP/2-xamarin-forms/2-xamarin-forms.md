# Xamarin forms desde cero con Visual studio 2022
[Tutorial Canal C√≥digo 369](https://www.youtube.com/watch?v=GtrDcqRiDlA&t=636s)

Fundado en 2011 como proyecto independiente que permit√≠a trabajar bajo una sola base de c√≥digo apps para android y iOS.

![Xamarin forms](https://i.postimg.cc/P5qZ9CP2/1-xamarin-forms.png)

En el 2016 Microsoft compra Xamarin y lo convierte en Xamarin forms.

|Frontend |Backend |
|---------|--------|
|XAML     |C#      |

![XAML y HTML](https://i.postimg.cc/2j1TYyXK/1-xaml-html.png)

## XAML
Nace a partir de HTML que es un lenguaje de marcado. Se podr√≠a decir que XAML es como el HTML para dispositivos m√≥viles de Microsoft. 

XAML tambi√©n soporta CSS.

## Patr√≥n de software MVVM

Este patr√≥n separa todo lo que est√° en el backend y lo pasa a una nueva  vista llamada Modelo. Luego al unirlos para darle funcionalidad al Frontend se utilizan Binding (Vinculante). 

![MVVM](https://i.postimg.cc/PqwGVZPs/1-mvvm.png)

## Instalaci√≥n de Visual Studio 2022

Este link funciona en Obsidian y te lleva directo a las notas donde tengo la instalaci√≥n de VS 2022 üî•üêØ
[[1-Csharp-intro#2. Instalaci√≥n de Visual Studio Community]]

Para mayor detalle en la instalaci√≥n ver la [Documentaci√≥n](https://learn.microsoft.com/en-us/xamarin/get-started/installation/?pivots=windows-vs2022)

üî• Abrimos: Visual Studio Installer 
- Visual Studio Community 2022     
- Modificar 
- Cargas de trabajo: M√≥viles y de escritorio(5) 
	- ‚úÖ Desarrollo de la interfaz de usuario de aplicaciones multiplataforma
		- Cree aplicaciones de Android, iOS, Windows y Mac desde un √∫nico c√≥digo base con C# mediante .NET MAUI
	- Antes: Desarrollo para dispositivos m√≥viles con .NET

Panel izquierdo: Detalles de instalaci√≥n 
- Desarrollo de la interfaz de usuario de aplicaciones multiplataforma de .NET
	- En Opcional 
		- ‚úÖ Xamarin 
- Instalar durante la descarga: üõ°Modificar

## Instalar MEMU Play 

[MEMU PLAY Download](https://www.memuplay.com/)

Ejecutar instalador    
- Instalar r√°pidamente 
- Rechazar antivirus 
- Rechazar RAV
- Esperar
- Reiniciar pc
- Abrir Ejecutar MEmu

Otra alternativa es: [NoxPlayer](https://es.bignox.com/)

### Configurar MEMU Play
- Buscar las 3 ‚ûñ
- Configuraciones 
- üñ• Mostrar
- Resoluci√≥n: üîò Celular 720 * 1280 (240dpi)
- Ok
- Reiniciar ahora

### Configurar la parte interna
Hacemos esto para no tener problemas con VS

- ‚öôAjustes 
- Informaci√≥n del tablet 
	- N√∫mero de compilaci√≥n varias veces ‚ú®‚ú® 
		- Con esto activas las opciones de desarrollo
	- ‚¨Ö Retroceder 
- Opciones del desarrollo
	- ‚úÖ S√≠ en la parte superior 
	- ‚úÖ Actualizaciones del sistema autom√°ticas 
	- ‚úÖ Depuraci√≥n por USB: Aceptar 
	- ‚¨Ö Retroceder
- Seguridad 
	- ‚úÖ Or√≠genes desconocidos 

### Play store 
Iniciar sesi√≥n con la cuenta de Google

## Configurar dispositivo Android

Para depurar con un dispositivo Android, puede configurar su dispositivo Android para conectarse a Visual Studio o usar un emulador.¬†Elija el escenario que sea m√°s aplicable a usted.

[Pasos detallados](https://dotnet.microsoft.com/en-us/learn/xamarin/hello-world-tutorial/devicesetup)

## Crear un proyecto

![Convertor cm to m](https://i.postimg.cc/L8RLJNcg/2-project-cm-to-m.png)

Todos los lenguajes ‚û° Todas las plataformas ‚û° M√≥vil

1. Aplicaci√≥n m√≥vil (Xamarin.Forms) 
	- Plantilla de varios proyectos para compilar aplicaciones para iOS y Android con Xamarin y Xamarin.Forms     
	- C# - Android - iOS - Windows - M√≥vil 

2.  **Configure Your new project**   
    Name, location, solution, solution name‚Ä¶
    - Conversor
    - ‚úÖ Colocar la soluci√≥n y el proyecto en el mismo directorio. 
    - Siguiente

3. Nueva aplicaci√≥n m√≥vil    
	Seleccionar una plantilla para la aplicaci√≥n  
	- En blanco: Una aplicaci√≥n vac√≠a con una sola pantalla inicial 
	Tengo previsto desarrollar:
		- ‚úÖ Android
		- ‚úÖ iOS

Puede ser otro pero dejo este como ejemplo:     
‚ñ∂ `Google G011A (Android 7.1 - API 25)`üîΩ      
Tener abierto previamente MEMU Play    

[Compilaci√≥n de la primera aplicaci√≥n](https://learn.microsoft.com/es-es/xamarin/get-started/first-app/?pivots=windows-vs2022)

## Distribuci√≥n del proyecto 

- ‚ñ∂ `C#` Conversor:      
	C√≥digo base, se va a compartir tanto para Android como para iOS    
	- ‚ñ∂ Dependencias:    
		Paquetes a instalar 
	- üìë App.xaml: `Frontend`   
		- ‚ñ∂ `C#` App.xaml.cs: `Backend`   
			Desde aqu√≠ se arranca la aplicaci√≥n. Aqu√≠ podemos decidir desde que p√°gina va a inicializarse 
	```cs
	public App()
	        {
	            InitializeComponent();
	
	            MainPage = new MainPage(); //üëàüëÄ
	            //P√°gina desde donde se va a arrancar
	        }
	```
	- üìë MainPage.xaml: `Frontend`     
		Viene por defecto y es lo que se muestra cuando corremos el programa.   
		- ‚ñ∂ `C#`MainPage.xaml.cs   `Backend`   

Ejecutar en la parte superior:   
‚ñ∂ `Samsung SM-G985F (Android 7.1 - API 25)`üîΩ     

Detenemos el programa:     
üü• Detener depuraci√≥n 

üî• Hot reload     
Si modificamos el archivo MainPage.xaml los cambios se ver√°n autom√°ticamente en nuestro emulador. 

## Crear p√°gina nueva    

En el Explorador de soluciones    
- **Clic derecho...** sobre ‚ñ∂ `C#` Conversor:      
	- Agregar: Nueva carpeta: Nombre: **Vistas**
- **Clic derecho...** sobre Vistas   
- Agregar: Nuevo elemento 
- Buscar xaml: üìë P√°gina de contenido (ContentPage)
- Nombrar: **Menuprincipal.xaml**

üî• Agregar archivo creado a la `App.xaml.cs` 

```cs
using Conversor.Vistas;
```

```cs
	public App()
	        {
	            InitializeComponent();
	
	            MainPage = new Menuprincipal(); //üëàüëÄ
	            //P√°gina desde donde se va a arrancar
	        }
```

En caso de alg√∫n alg√∫n error, reiniciar el proyecto o la m√°quina. En caso de persistir alg√∫n error trabajar con los archivos anteriores y eliminar la carpeta creada.    
- `MainPage.xaml`
	- `C# MainPage.xaml.cs`


üî• `MainPage.xaml` or `Menuprincipal.xaml`
```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="_1_conversor.MainPage">

    <StackLayout BackgroundColor="#ffe5b6">
        <Label Text="Conversor"
               FontSize="40"
               FontAttributes="Bold"
               Margin="0, 20, 0, 0"
               HorizontalOptions="Center"/>
        <Frame VerticalOptions="FillAndExpand"
               Margin="20"
               CornerRadius="20"
               HasShadow="False">
            <StackLayout VerticalOptions="Center"
                         Spacing="20">
                <Image Source="https://i.postimg.cc/DwH6gJMq/cinta-metrica.png"/>
                <Label Text="(cm) a (m)"
                       FontAttributes="Bold"
                       FontSize="40"
                       HorizontalOptions="Center"/>
                <Button Text="Iniciar"
                        TextTransform="None"
                        Background="#ffdc7a"
                        CornerRadius="10"
                        FontSize="Medium"
                        FontAttributes="Bold"/>
            </StackLayout>
        </Frame>
    </StackLayout>

</ContentPage>
```

Descargar Just Color Picker 
Opciones: Control + s  

üü• Detener depuraci√≥n 

üî• Para mantener el orden en caso todo el c√≥digo se desordene:      
Formatear:      
- Herramientas 
- Opciones 
- Editor de texto üîΩ
	- XAML 
		- Formatting üîΩ
			- Spacing 
				- Espaciado de atributos
					- [x] Poner cada atributo en una l√≠nea diferente
				- Espacio de elementos
					- [x] Quitar l√≠neas vac√≠as del contenido 
- Control + K + D

## Crear segunda p√°gina    

En el Explorador de soluciones    
- **Clic derecho...** sobre ‚ñ∂ `C#` Conversor:      
- Agregar: Nuevo elemento 
- Buscar xaml: üìë P√°gina de contenido (ContentPage)
- Nombrar: **Convertir.xaml**

üî• Agregar archivo creado a la `App.xaml.cs` 

```cs
using Conversor.Vistas;//üëàüëÄ  
// Esto o solo Conversor, dependiendo si se creo la carpeta Vistas o no
```

```cs
	public App()
	        {
	            InitializeComponent();
	
	            MainPage = new Convertir(); //üëàüëÄ
	            //P√°gina desde donde se va a arrancar
	        }
```

üìå Nota importante: Para este ejemplo nombr√© al proyecto como `1-conversor`, pero dentro de los archivos xaml se debe escribir como `_1_conversor` de lo contrario nos mostrar√° un mensaje de error: 

> No se encontr√≥ el tipo ". Compruebe que no falta una referencia a un ensamblado y que se han compilado todos los ensamblados a los que se hace referencia. 

üî• `Convertir.xaml`    

```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Conversor.Vistas.Convertir">
    <Grid BackgroundColor="#ffdc7b">
        <StackLayout VerticalOptions="Center"
                     Margin="20">
            <Image Source="https://i.postimg.cc/C5cj8GSj/world-wide-web.png" 
                   Margin="20"/>
            <Frame HasShadow="False"
                   CornerRadius="15">
                <Entry Keyboard="Numeric"
                       Placeholder="Centimetros (cm)"
                       TextColor="Black"
                       PlaceholderColor="Black"
                       FontSize="Large" />
            </Frame>
            <Button Text="Calcular"
                    CornerRadius="10"
                    FontSize="Large"
                    FontAttributes="Bold"
                    Margin="0, 20, 0, 0" 
                    TextTransform="None"
                    BackgroundColor="#7d5bf2"
                    TextColor="White"/>
            <StackLayout Orientation="Horizontal">
                <Label Text="Resultado:"
                       FontSize="Large"
                       FontAttributes="Bold"
                       VerticalOptions="Center"/>
                <Label Text="0.00"
                       FontSize="Large"
                       FontAttributes="Bold"
                       VerticalOptions="Center" />
            </StackLayout>
            <Button Text="Volver"
                    TextTransform="None"
                    BackgroundColor="White"
                    TextColor="Black"
                    FontSize="Large"
                    FontAttributes="Bold"
                    HorizontalOptions="Center"
                    CornerRadius="10"/>
        </StackLayout>
    </Grid>
</ContentPage>
```


## Navegaci√≥n entre p√°ginas 

![Navigation](https://i.postimg.cc/zGkvdJ9f/3-navegation.png)

üî• `App.xaml.cs`

Para navegar de la p√°gina 1 a la p√°gina 2 necesitamos que la pagina 1 sea de tipo `NavigationPage`.

```cs
public App()
        {
            InitializeComponent();
			
            MainPage = new NavigationPage(new Menuprincipal());
        }
```

En este caso la p√°gina inicial ser√° `Menuprincipal.xaml`  

üî• `Menuprincipal.xaml`  

```xml
<Button Text="Iniciar"
    TextTransform="None"
    Background="#ffdc7a"
    CornerRadius="10"
    FontSize="Medium"
    FontAttributes="Bold" 
    
    üëÄüëá
    x:Name="btniniciar"üëàüëÄ   
    Clicked="btniniciar_Clicked"/>üëàüëÄ
    üëÄ‚òù
```

- Antes de colocarle nombre al `Clicked`, hacer esto 
- `Clicked= " "` <**Nuevo controlador de eventos**>
- Doble clic dentro de `" "` y autocompleta
	-`Clicked= " Doble clic"`

Esto crear√° un evento dentro de `Menuprincipal.xaml.cs`   

```cs
public partial class Menuprincipal : ContentPage
    {
        public Menuprincipal()
        {
            InitializeComponent();
        }
		
		üëÄüëá
        private void btniniciar_Clicked(object sender, EventArgs e)
        {
		
        }
    }
```

Ahora para navegar de la p√°gina 1 a la p√°gina 2 se utiliza:
`await Navigation.PushAsync(new Pagina2());`

![Await navigation](https://i.postimg.cc/q7PghGqC/3-await-navigation.png)

üî• `Menuprincipal.xaml.cs`  

```cs
private void btniniciar_Clicked(object sender, EventArgs e)
{
    Navigation.PushAsync(new Convertir());
}
```

Probamos el programa...  



üî• `Menuprincipal.xaml`    
Para borrar la barra superior color azul ‚¨Ö llamada Navigation Page:     

```xml
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Conversor.Vistas.Menuprincipal"
             
             üëÄüëá
             NavigationPage.HasNavigationBar="False"> üëàüëÄ
```

Hacemos lo mismo en Convertir.xaml   

üî• `Convertir.xaml`     

```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Conversor.Vistas.Convertir"

			 üëÄüëá
             NavigationPage.HasNavigationBar="False"> üëàüëÄ
```

Detenemos el proyecto para seguir programando...

Ahora agregamos un bot√≥n para volver.   

```xml
<Button Text="Volver"
    TextTransform="None"
    BackgroundColor="White"
    TextColor="Black"
    FontSize="Large"
    FontAttributes="Bold"
    HorizontalOptions="Center"
    CornerRadius="10"
	
	üëÄüëá
    x:Name="btnvolver" üëàüëÄ
    Clicked="btnvolver_Clicked"/> üëàüëÄ
    üëÄ‚òù
```

Esto genera en el archivo `Convertir.xaml.cs` un evento.      

```cs
public Convertir()
        {
            InitializeComponent();
        }
		
		üëÄüëá
        private void btnvolver_Clicked(object sender, EventArgs e)
        {
		
        }
```

Despu√©s agregamos `Navigation.PopAsync()` para regresar.

```cs
private void btnvolver_Clicked(object sender, EventArgs e)
{
    Navigation.PopAsync(); üëàüëÄ
}
```

Corremos el programa

üî• `Convertir.xaml`    
Agregamos un nombre al Entry, al Label y al Button calcular   

Entry   
```xml
<Frame HasShadow="False"
        CornerRadius="15">
    <Entry Keyboard="Numeric"
            Placeholder="Centimetros (cm)"
            TextColor="Black"
            PlaceholderColor="Black"
            FontSize="Large"
            
            üëÄüëá
            x:Name="txtcm"/> üëàüëÄ
</Frame>
```

Label    
```xml
<StackLayout Orientation="Horizontal">
    <Label Text="Resultado:"
            FontSize="Large"
            FontAttributes="Bold"
            VerticalOptions="Center"/>
    <Label Text="0.00"
            FontSize="Large"
            FontAttributes="Bold"
            VerticalOptions="Center"
            
            üëÄüëá
            x:Name="lblresultado"/> üëàüëÄ
</StackLayout>
```

Bot√≥n calcular 
```xml
<Button Text="Calcular"
    CornerRadius="10"
    FontSize="Large"
    FontAttributes="Bold"
    Margin="0, 20, 0, 0" 
    TextTransform="None"
    BackgroundColor="#7d5bf2"
    TextColor="White"
    
    üëÄüëá
    x:Name="btncalcular"
    Clicked="btncalcular_Clicked"/> üëàüëÄ
```

No olvidar seleccionar Nuevo controlador de eventos para crear el controlador de manera autom√°tica.   

Queda as√≠:      

```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Conversor.Vistas.Convertir"
             NavigationPage.HasNavigationBar="False"
             Visual="Material">
    <Grid BackgroundColor="#ffdc7b">
        <StackLayout VerticalOptions="Center"
                     Margin="20">
            <Image Source="world.png" 
                   Margin="20"/>
            <Frame HasShadow="False"
                   CornerRadius="15">
                <Entry Keyboard="Numeric"
                       Placeholder="Centimetros (cm)"
                       TextColor="Black"
                       PlaceholderColor="Black"
                       FontSize="Large"
                       x:Name="txtcm"/>
            </Frame>
            <Button Text="Calcular"
                    CornerRadius="10"
                    FontSize="Large"
                    FontAttributes="Bold"
                    Margin="0, 20, 0, 0" 
                    TextTransform="None"
                    BackgroundColor="#7d5bf2"
                    TextColor="White"
                    x:Name="btncalcular"
                    Clicked="btncalcular_Clicked"/>
            <StackLayout Orientation="Horizontal">
                <Label Text="Resultado:"
                       FontSize="Large"
                       FontAttributes="Bold"
                       VerticalOptions="Center"/>
                <Label Text="0.00"
                       FontSize="Large"
                       FontAttributes="Bold"
                       VerticalOptions="Center"
                       x:Name="lblresultado"/>
            </StackLayout>
            <Button Text="Volver"
                    TextTransform="None"
                    BackgroundColor="White"
                    TextColor="Black"
                    FontSize="Large"
                    FontAttributes="Bold"
                    HorizontalOptions="Center"
                    CornerRadius="10"
                    x:Name="btnvolver"
                    Clicked="btnvolver_Clicked"/>
        </StackLayout>
    </Grid>
</ContentPage>
```

üî• `Convertir.xaml.cs`    

Calcular

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using Xamarin.Forms;
using Xamarin.Forms.Xaml;

namespace Conversor.Vistas
{
    [XamlCompilation(XamlCompilationOptions.Compile)]
    public partial class Convertir : ContentPage
    {
        double cm;
        double m;

        public Convertir()
        {
            InitializeComponent();
        }

        private void Calcular()
        {
            cm = Convert.ToDouble(txtcm.Text);
            m = cm / 100;
            lblresultado.Text = m.ToString() + " m";
        }
		
		
		//Detectar valores vacios 
        private void Validar()
        {
            if (!string.IsNullOrEmpty(txtcm.Text))
            {
                Calcular();
            }
            else
            {
                DisplayAlert("Error", "Ingrese una cantidad", "OK");
            }
        }

        private void btnvolver_Clicked(object sender, EventArgs e)
        {
            Navigation.PopAsync();
        }

        private void btncalcular_Clicked(object sender, EventArgs e)
        {
            Validar();
        }
    }
}
```


Corremos el programa...    

## Agregar im√°genes en local 

Explorador de soluciones:     
- üì± Conversor.Android
- üìÅ Resources 
	- üìÅ drawable: Clic derecho y pegar
		- Arrastrar o Copiamos la imagen 

üìå De no poderse, reiniciar el proyecto.

üî• Dentro de `Menuprincipal.xaml`     

Cambiamos:     
```xml
<Image Source="https://i.postimg.cc/DwH6gJMq/cinta-metrica.png" />
```

Por:     
```xml
<Image Source="cinta.png" />
```

üî• Dentro  de `Convertir.xaml`   

Cambiamos:     
```xml
<Image Source="https://i.postimg.cc/C5cj8GSj/world-wide-web.png" />
```

Por:   
```xml
<Image Source="world.png" />
```


## Mejorar proyecto con un paquete Nuget 

Detener proyecto    

Explorador de soluciones: 
- Soluci√≥n "Conversor" : Clic derecho 
- Administrar paquetes NuGet para la soluci√≥n 
- Examinar: 
	- Buscar: `Xamarin.Forms.Visual.Material`
	- [x] Conversor.Android\Conversor
	- [x] Conversor.iOS\Conversor  
- Instalar y aceptamos 

Si encontramos en Dependencias algo llamado **Net Frameworks** eso quiere decir que va a afectar a todo el proyecto y puedo marcar todos los [ x ] 


Ahora debemos afectar al proyecto android   

üî• `Conversor.Android` -> `MainActivity.cs`: Ingresamos doble clic 

Agregamos la referencia al nuevo paquete instalado:      
```cs
protected override void OnCreate(Bundle savedInstanceState)
{
    base.OnCreate(savedInstanceState);
	
    Xamarin.Essentials.Platform.Init(this, savedInstanceState);
    global::Xamarin.Forms.Forms.Init(this, savedInstanceState);
    
    üëÄüëá   
    global::Xamarin.Forms.FormsMaterial.Init(this, savedInstanceState); üëàüëÄ
    üëÄ‚òù
    
    LoadApplication(new App());
}
```

Para finalizar veamos como afectar√≠a a la vista en Xaml   

üî• `Convertir.xaml`     
```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Conversor.Vistas.Convertir"
             NavigationPage.HasNavigationBar="False"
             
             üëÄüëá
             Visual="Material">
```


Corremos el programa 


## Resultado 

![Project](https://i.postimg.cc/MZLsWVXR/result.png)




---

---
‚ùÑ Ejemplo random de Grid en Xamarin - Xaml 
```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Conversor.Vistas.Convertir">
    <Grid RowDefinitions="*, *"
          ColumnDefinitions="*, *">
        <Button Text="Hola" Grid.Row="1"
                Grid.Column="1"/>
    </Grid>
</ContentPage>
```

üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤üé≤
```cs
```

```xml
```
## Emojis:  
<details>
  <summary>Haz click aqu√≠ para ver los emojis üëÄ</summary>

  <br/>

**üî• Emojis:**        
- üî•¬†‚ùÑ¬†‚ú®¬†üìå¬†üé≤ üîç¬†üéâ     
- ü§¥ü¶Å¬†üßîüêØ¬†¬†üëÄ üëâ üëà ‚òù üëá   
- üòä üëàüëÄ üòå üòç üßõ‚Äç‚ôÇÔ∏è üìÇ üìÅ   üóÇ üìë
- üü• ‚¨ú ‚¨õ ‚óº ‚óª üî∑ üî∂ üîª üî∫ üî¥ üü£ üîµ üîò     
- ‚úî ‚ûï ‚Üï ‚Üî ‚û° ‚¨á ‚¨Ö ‚úÖ ‚ñ∂ ‚ùå ‚ùó            
- üß∞ ‚õì üí° üåê üñ•    üõ° ‚öô üîΩ    
- üîÖ üîÜ üåö üåó       

</details>